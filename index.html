<html>
  <body>
    <h1>Valves WIP</h1>
    <p><input type="checkbox" id="valve0">Valve1</p>
    <p><input type="checkbox" id="valve1">Valve2</p>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/reconnecting-websocket/1.0.0/reconnecting-websocket.min.js" integrity="sha512-B4skI5FiLurS86aioJx9VfozI1wjqrn6aTdJH+YQUmCZum/ZibPBTX55k5d9XM6EsKePDInkLVrN7vPmJxc1qA==" crossorigin="anonymous"></script>
    <script>
      const socket = new ReconnectingWebSocket('ws://rpi-veni000:8080');
      let valvesState = {};
      const valve0CheckBox = document.getElementById('valve0');
      const valve1CheckBox = document.getElementById('valve1');
      socket.onmessage = function(event) {
        valvesState = JSON.parse(event.data);
        valve0CheckBox.checked = valvesState.valve0 == 'open' ? true : false;
        valve1CheckBox.checked = valvesState.valve1 == 'open' ? true : false;
      };
      valve0CheckBox.onclick = function() {
        socket.send(JSON.stringify({valve0: 'toggle'}));
      };
      valve1CheckBox.onclick = function() {
        socket.send(JSON.stringify({valve1: 'toggle'}));
      };
    </script>
  </body>
</html>
